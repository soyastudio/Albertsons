--liquibase formatted sql
--changeset SYSTEM:EPE_TRANSACTION_HEADER_EXCEPTIONS runOnChange:true splitStatements:false OBJECT_TYPE:TABLE
use database <<EDM_DB_NAME>>;
use schema <<EDM_DB_NAME>>.DW_C_STAGE;

create or replace TABLE EPE_TRANSACTION_HEADER_EXCEPTIONS (
	TRANSACTION_INTEGRATION_ID NUMBER(38,5),
	TERMINAL_NBR VARCHAR(16777216),
	TRANSACTION_ID NUMBER(38,0),
	ORDER_ID VARCHAR(16777216),
	HOUSEHOLD_ID NUMBER(38,0),
	STATUS_CD VARCHAR(16777216),
	CREATE_DT DATE,
	SOURCE_SYSTEM_CD VARCHAR(16777216),
	TOTAL_CARD_SAVINGS_AMT NUMBER(38,5),
	TRANSACTION_TOTAL_AMT NUMBER(38,5),
	UPDATEDDATE DATE,
	FILENAME VARCHAR(16777216),
	DML_TYPE VARCHAR(16777216),
	SAMEDAY_CHG_IND VARCHAR(16777216),
	EXCEPTION_REASON VARCHAR(16777216),
	DW_CREATE_TS TIMESTAMP_LTZ(9),
	STORE_NBR VARCHAR(16777216),
	REGISTER_TRANSACTION_SEQUENCE_NBR NUMBER(38,0),
	TRANSACTION_TS TIMESTAMP_NTZ(9),
	FULFILLMENT_STORE_NBR VARCHAR(16777216)
);


create or replace TABLE EPE_TRANSACTION_ITEM_EXCEPTIONS (
	TRANSACTION_INTEGRATION_ID NUMBER(38,0),
	UPC_NBR NUMBER(38,0),
	DEPARTMENT_NBR NUMBER(38,0),
	DISCOUNT_ALLOWED_IND BOOLEAN,
	ITEM_SEQUENCE_ID NUMBER(38,0),
	POINTS_APPLY_ITEM_IND BOOLEAN,
	ITEM_UOM_CD VARCHAR(16777216),
	SELL_BY_WEIGHT_CD VARCHAR(50),
	DEPARTMENT_GROUP_NBR NUMBER(38,0),
	LINK_PLU_NBR VARCHAR(16777216),
	ITEM_PLU_NBR VARCHAR(16777216),
	CLIPPED_OFFER_START_TS TIMESTAMP_LTZ(9),
	CLIPPED_OFFER_END_TS TIMESTAMP_LTZ(9),
	PRICE_PER_ITEM_AMT NUMBER(38,5),
	BASE_PRICE_AMT NUMBER(38,5),
	ITEM_PRICE_AMT NUMBER(38,5),
	NET_PROMOTION_AMT NUMBER(38,5),
	UNIT_PRICE_AMT NUMBER(38,5),
	EXTENDED_PRICE_AMT NUMBER(38,5),
	BASE_PRICE_PER_AMT NUMBER(38,5),
	CLUB_CARD_SAVINGS_AMT NUMBER(38,5),
	AVERAGE_WEIGHT_QTY NUMBER(38,5),
	ITEM_UNIT_QTY NUMBER(38,5),
	ITEM_QTY NUMBER(38,5),
	TERMINALNUMBER VARCHAR(16777216),
	TRANSACTIONNUMBER NUMBER(38,0),
	UPDATEDDATE DATE,
	FILENAME VARCHAR(16777216),
	DML_TYPE VARCHAR(16777216),
	SAMEDAY_CHG_IND VARCHAR(16777216),
	EXCEPTION_REASON VARCHAR(16777216),
	DW_CREATE_TS TIMESTAMP_LTZ(9),
	TRANSACTIONTIMESTAMP TIMESTAMP_NTZ(9)
);

create or replace TABLE EPE_TRANSACTION_CARD_SAVINGS_EXCEPTIONS (
	TRANSACTION_INTEGRATION_ID NUMBER(38,0),
	SAVINGS_CATEGORY_ID NUMBER(38,0),
	SAVINGS_CATEGORY_NM VARCHAR(16777216),
	SAVINGS_AMT NUMBER(38,5),
	TERMINALNUMBER VARCHAR(16777216),
	TRANSACTIONNUMBER NUMBER(38,0),
	UPDATEDDATE DATE,
	FILENAME VARCHAR(16777216),
	DML_TYPE VARCHAR(16777216),
	SAMEDAY_CHG_IND VARCHAR(16777216),
	EXCEPTION_REASON VARCHAR(16777216),
	DW_CREATE_TS TIMESTAMP_LTZ(9),
	TRANSACTIONTIMESTAMP TIMESTAMP_NTZ(9)
);

create or replace TABLE EPE_TRANSACTION_ERROR_EXCEPTIONS (
	TRANSACTION_INTEGRATION_ID NUMBER(38,0),
	UPC_NBR NUMBER(38,0),
	ITEM_SEQUENCE_ID NUMBER(38,0),
	PRICING_ERROR_CD VARCHAR(16777216),
	PRICING_ERROR_DSC VARCHAR(16777216),
	TERMINALNUMBER VARCHAR(16777216),
	TRANSACTIONNUMBER NUMBER(38,0),
	UPDATEDDATE DATE,
	FILENAME VARCHAR(16777216),
	DML_TYPE VARCHAR(16777216),
	SAMEDAY_CHG_IND VARCHAR(16777216),
	EXCEPTION_REASON VARCHAR(16777216),
	DW_CREATE_TS TIMESTAMP_LTZ(9),
	TRANSACTIONTIMESTAMP TIMESTAMP_NTZ(9)
);

create or replace TABLE EPE_TRANSACTION_HEADER_SAVING_POINTS_EXCEPTIONS (
	TRANSACTION_INTEGRATION_ID NUMBER(38,0),
	OFFER_ID NUMBER(38,0),
	POINTS_PROGRAM_NM VARCHAR(16777216),
	POINTS_BURNED_NBR NUMBER(38,0),
	POINTS_EARNED_NBR NUMBER(38,0),
	SCORECARD_TXT VARCHAR(16777216),
	TERMINALNUMBER VARCHAR(16777216),
	TRANSACTIONNUMBER VARCHAR(16777216),
	UPDATEDDATE VARCHAR(16777216),
	FILENAME VARCHAR(16777216),
	DML_TYPE VARCHAR(5),
	SAMEDAY_CHG_IND BOOLEAN,
	EXCEPTION_REASON VARCHAR(1000),
	DW_CREATE_TS TIMESTAMP_LTZ(9),
	TRANSACTIONTIMESTAMP TIMESTAMP_NTZ(9)
);

create or replace TABLE EPE_TRANSACTION_HEADER_SAVINGS_EXCEPTIONS (
	TRANSACTION_INTEGRATION_ID NUMBER(38,0),
	OFFER_ID NUMBER(38,0),
	SAVING_DSC VARCHAR(16777216),
	SOURCE_SYSTEM_CD VARCHAR(16777216),
	REDEMPTION_AMT NUMBER(38,5),
	REDEMPTION_CNT NUMBER(38,0),
	NON_DIGITAL_OFFER_IND BOOLEAN,
	TERMINALNUMBER VARCHAR(16777216),
	TRANSACTIONNUMBER VARCHAR(16777216),
	UPDATEDDATE VARCHAR(16777216),
	FILENAME VARCHAR(16777216),
	DML_TYPE VARCHAR(5),
	SAMEDAY_CHG_IND BOOLEAN,
	EXCEPTION_REASON VARCHAR(1000),
	DW_CREATE_TS TIMESTAMP_LTZ(9),
	CALCULATE_USAGE_IND BOOLEAN,
	DISCOUNT_MESSAGE_TXT VARCHAR(16777216),
	NET_PROMOTION_AMT NUMBER(38,5),
	USAGE_CNT NUMBER(38,0),
	DISCOUNT_TYPE_TXT VARCHAR(16777216),
	DISCOUNT_LEVEL_TXT VARCHAR(16777216),
	SAVINGS_CATEGORY_ID NUMBER(38,0),
	SAVINGS_CATEGORY_NM VARCHAR(16777216),
	PROGRAM_CD VARCHAR(16777216),
	START_DT DATE,
	END_DT DATE,
	EXTERNAL_OFFER_ID VARCHAR(16777216),
	TRANSACTIONTIMESTAMP TIMESTAMP_NTZ(9),
	PROMO_CD VARCHAR(16777216)
);

create or replace TABLE EPE_TRANSACTION_ITEM_SAVINGS_EXCEPTIONS (
	TRANSACTION_INTEGRATION_ID NUMBER(38,0),
	UPC_NBR NUMBER(38,0),
	OFFER_ID NUMBER(38,0),
	ITEM_SEQUENCE_ID NUMBER(38,0),
	SAVINGS_CATEGORY_NM VARCHAR(16777216),
	DISCOUNT_MESSAGE_TXT VARCHAR(16777216),
	SOURCE_SYSTEM_CD VARCHAR(16777216),
	DISCOUNT_TYPE_TXT VARCHAR(16777216),
	DISCOUNT_DSC VARCHAR(16777216),
	DISCOUNT_LEVEL_TXT VARCHAR(16777216),
	SAVINGS_CATEGORY_ID NUMBER(38,0),
	MIN_PURCHASE_QTY NUMBER(9,2),
	DISCOUNT_AMT NUMBER(38,5),
	DISCOUNT_QTY NUMBER(9,2),
	NON_DIGITAL_OFFER_IND BOOLEAN,
	TERMINALNUMBER VARCHAR(16777216),
	TRANSACTIONNUMBER VARCHAR(16777216),
	UPDATEDDATE VARCHAR(16777216),
	FILENAME VARCHAR(16777216),
	DML_TYPE VARCHAR(5),
	SAMEDAY_CHG_IND BOOLEAN,
	EXCEPTION_REASON VARCHAR(1000),
	DW_CREATE_TS TIMESTAMP_LTZ(9),
	CALCULATE_USAGE_IND BOOLEAN,
	NET_PROMOTION_AMT NUMBER(38,5),
	USAGE_CNT NUMBER(38,0),
	PROGRAM_CD VARCHAR(16777216),
	START_DT DATE,
	END_DT DATE,
	EXTERNAL_OFFER_ID VARCHAR(16777216),
	TRANSACTIONTIMESTAMP TIMESTAMP_NTZ(9),
	PROMO_CD VARCHAR(16777216)
);


create or replace TABLE EPE_TRANSACTION_USAGE_EXCEPTIONS (
	TRANSACTION_INTEGRATION_ID NUMBER(38,0),
	SEQUENCE_NBR NUMBER(38,0),
	OFFER_ID NUMBER(38,0),
	ACTION_TYPE_CD VARCHAR(16777216),
	EXTERNAL_OFFER_ID VARCHAR(16777216),
	TERMINALNUMBER VARCHAR(16777216),
	TRANSACTIONNUMBER NUMBER(38,0),
	FILENAME VARCHAR(16777216),
	UPDATEDDATE DATE,
	DML_TYPE VARCHAR(16777216),
	SAMEDAY_CHG_IND VARCHAR(16777216),
	EXCEPTION_REASON VARCHAR(16777216),
	DW_CREATE_TS TIMESTAMP_LTZ(9),
	TRANSACTIONTIMESTAMP TIMESTAMP_NTZ(9)
);
