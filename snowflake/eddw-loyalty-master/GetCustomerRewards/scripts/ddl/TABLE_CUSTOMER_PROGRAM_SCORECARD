USE Database <<EDM_DB_NAME>>;
USE Schema DW_C_LOYALTY;

create or replace TRANSIENT TABLE CUSTOMER_PROGRAM_SCORECARD (
	BALANCE_UPDATE_TS TIMESTAMP_LTZ(9) NOT NULL COMMENT 'Balance_Update_Ts',
	HOUSEHOLD_ID NUMBER(38,0) NOT NULL COMMENT 'Household_Id',
	PROGRAM_TYPE_CD VARCHAR(50) NOT NULL COMMENT 'Program_Type_Cd',
	PROGRAM_DSC VARCHAR(500) NOT NULL COMMENT 'Program_Dsc',
	DW_FIRST_EFFECTIVE_DT DATE NOT NULL COMMENT 'DW_First_Effective_Dt',
	DW_LAST_EFFECTIVE_DT DATE NOT NULL COMMENT 'DW_Last_Effective_Dt',
	PROGRAM_VALUE_QTY NUMBER(38,0) COMMENT 'Program_Value_Qty',
	PROGRAM_VALIDITY_END_DT DATE COMMENT 'Program_Validity_End_Dt',
	PROGRAM_MODIFY_TS TIMESTAMP_LTZ(9) COMMENT 'Program_Modify_Ts',
	DW_CREATE_TS TIMESTAMP_LTZ(9) COMMENT 'DW_CREATE_TS',
	DW_LAST_UPDATE_TS TIMESTAMP_LTZ(9) COMMENT 'DW_LAST_UPDATE_TS',
	DW_SOURCE_CREATE_NM VARCHAR(255) COMMENT 'DW_SOURCE_CREATE_NM',
	DW_SOURCE_UPDATE_NM VARCHAR(255) COMMENT 'DW_SOURCE_UPDATE_NM',
	DW_LOGICAL_DELETE_IND BOOLEAN COMMENT 'DW_LOGICAL_DELETE_IND',
	DW_CURRENT_VERSION_IND BOOLEAN COMMENT 'DW_CURRENT_VERSION_IND',
	primary key (BALANCE_UPDATE_TS, HOUSEHOLD_ID, PROGRAM_TYPE_CD, PROGRAM_DSC, DW_FIRST_EFFECTIVE_DT, DW_LAST_EFFECTIVE_DT)
);
