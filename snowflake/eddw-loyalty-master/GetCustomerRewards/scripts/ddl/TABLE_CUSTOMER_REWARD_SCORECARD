USE Database <<EDM_DB_NAME>>;
USE Schema DW_C_LOYALTY;

	create or replace TABLE CUSTOMER_REWARD_SCORECARD (
	BALANCE_UPDATE_TS TIMESTAMP_LTZ(9) NOT NULL COMMENT 'Balance_Update_Ts',
	HOUSEHOLD_ID NUMBER(38,0) NOT NULL COMMENT 'Household_Id',
	REWARD_BUCKET_TYPE_CD VARCHAR(50) NOT NULL COMMENT 'Reward_Bucket_Type_Cd',
	DW_FIRST_EFFECTIVE_DT DATE NOT NULL COMMENT 'DW_First_Effective_Dt',
	DW_LAST_EFFECTIVE_DT DATE NOT NULL COMMENT 'DW_Last_Effective_Dt',
	REWARD_BUCKET_TYPE_DSC VARCHAR(250) COMMENT 'Reward_Bucket_Type_Dsc',
	REWARD_BUCKET_TYPE_SHORT_DSC VARCHAR(50) COMMENT 'Reward_Bucket_Type_Short_Dsc',
	REWARD_VALUE_QTY NUMBER(38,0) COMMENT 'Reward_Value_Qty',
	DW_CREATE_TS TIMESTAMP_LTZ(9) COMMENT 'DW_CREATE_TS',
	DW_LAST_UPDATE_TS TIMESTAMP_LTZ(9) COMMENT 'DW_LAST_UPDATE_TS',
	DW_SOURCE_CREATE_NM VARCHAR(255) COMMENT 'DW_SOURCE_CREATE_NM',
	DW_SOURCE_UPDATE_NM VARCHAR(255) COMMENT 'DW_SOURCE_UPDATE_NM',
	DW_LOGICAL_DELETE_IND BOOLEAN COMMENT 'DW_LOGICAL_DELETE_IND',
	DW_CURRENT_VERSION_IND BOOLEAN COMMENT 'DW_CURRENT_VERSION_IND',
	REWARD_VALIDITY_START_DT DATE,
	REWARD_VALIDITY_END_DT DATE,
	primary key (BALANCE_UPDATE_TS, HOUSEHOLD_ID, REWARD_BUCKET_TYPE_CD, DW_FIRST_EFFECTIVE_DT, DW_LAST_EFFECTIVE_DT)
);
