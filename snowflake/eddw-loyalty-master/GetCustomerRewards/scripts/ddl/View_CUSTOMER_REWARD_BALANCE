USE Database EDM_VIEWS_PRD;
USE Schema DW_VIEWS;

create or replace view EDM_VIEWS_PRD.DW_VIEWS.CUSTOMER_REWARD_BALANCE(
	HOUSEHOLD_ID COMMENT 'HOUSEHOLD_ID',
	BALANCE_UPDATE_TS COMMENT 'BALANCE_UPDATE_TS',
	DW_FIRST_EFFECTIVE_DT COMMENT 'DW_FIRST_EFFECTIVE_DT',
	DW_LAST_EFFECTIVE_DT COMMENT 'DW_LAST_EFFECTIVE_DT',
	REWARD_ORIGIN_CD COMMENT 'REWARD_ORIGIN_CD',
	REWARD_ORIGIN_DSC COMMENT 'REWARD_ORIGIN_DSC',
	REWARD_DOLLAR_POINT_QTY COMMENT 'REWARD_DOLLAR_POINT_QTY',
	REWARD_TOKEN_POINT_QTY COMMENT 'REWARD_TOKEN_POINT_QTY',
	REWARD_TOKEN_POINT_EXPIRY_QTY COMMENT 'REWARD_TOKEN_POINT_EXPIRY_QTY',
	REWARD_DOLLAR_START_TS COMMENT 'REWARD_DOLLAR_START_TS',
	REWARD_DOLLAR_END_TS COMMENT 'REWARD_DOLLAR_END_TS',
	REWARD_TOKEN_END_TS COMMENT 'REWARD_TOKEN_END_TS',
	REWARD_TOKEN_WILL_EXPIRY_END_TS COMMENT 'REWARD_TOKEN_WILL_EXPIRY_END_TS',
	DW_CREATE_TS COMMENT 'DW_CREATE_TS',
	DW_LAST_UPDATE_TS COMMENT 'DW_LAST_UPDATE_TS',
	DW_LOGICAL_DELETE_IND COMMENT 'DW_LOGICAL_DELETE_IND',
	DW_SOURCE_CREATE_NM COMMENT 'DW_SOURCE_CREATE_NM',
	DW_SOURCE_UPDATE_NM COMMENT 'DW_SOURCE_UPDATE_NM',
	DW_CURRENT_VERSION_IND COMMENT 'DW_CURRENT_VERSION_IND'
) COMMENT='VIEW for CUSTOMER_REWARD_BALANCE'
 as
SELECT
  HOUSEHOLD_ID,
 BALANCE_UPDATE_TS,
 DW_FIRST_EFFECTIVE_DT,
 DW_LAST_EFFECTIVE_DT,
 REWARD_ORIGIN_CD,
 REWARD_ORIGIN_DSC,
 REWARD_DOLLAR_POINT_QTY,
 REWARD_TOKEN_POINT_QTY,
 REWARD_TOKEN_POINT_EXPIRY_QTY,
 REWARD_DOLLAR_START_TS,
 REWARD_DOLLAR_END_TS,
 REWARD_TOKEN_END_TS,
 REWARD_TOKEN_WILL_EXPIRY_END_TS,
 DW_CREATE_TS,
 DW_LAST_UPDATE_TS,
 DW_LOGICAL_DELETE_IND,
 DW_SOURCE_CREATE_NM,
 DW_SOURCE_UPDATE_NM,
 DW_CURRENT_VERSION_IND
 FROM <<EDM_DB_NAME>>.DW_C_LOYALTY.CUSTOMER_REWARD_BALANCE;
